<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="dist/output.css" type="text/css" media="all" />
  <title>QuranQu - Home</title>
  <style type="text/css" media="all">
    #desk:checked~.deskripsi {
      display: block !important;
    }

    .lds-ellipsis {
      display: inline-block;
      position: relative;
      width: 80px;
      height: 80px;
    }

    .lds-ellipsis div {
      position: absolute;
      top: 33px;
      width: 13px;
      height: 13px;
      border-radius: 50%;
      background: #fff;
      animation-timing-function: cubic-bezier(0, 1, 1, 0);
    }

    .lds-ellipsis div:nth-child(1) {
      left: 8px;
      animation: lds-ellipsis1 0.6s infinite;
    }

    .lds-ellipsis div:nth-child(2) {
      left: 8px;
      animation: lds-ellipsis2 0.6s infinite;
    }

    .lds-ellipsis div:nth-child(3) {
      left: 32px;
      animation: lds-ellipsis2 0.6s infinite;
    }

    .lds-ellipsis div:nth-child(4) {
      left: 56px;
      animation: lds-ellipsis3 0.6s infinite;
    }

    @keyframes lds-ellipsis1 {
      0% {
        transform: scale(0);
      }

      100% {
        transform: scale(1);
      }
    }

    @keyframes lds-ellipsis3 {
      0% {
        transform: scale(1);
      }

      100% {
        transform: scale(0);
      }
    }

    @keyframes lds-ellipsis2 {
      0% {
        transform: translate(0, 0);
      }

      100% {
        transform: translate(24px, 0);
      }
    }
  </style>
</head>

<body class="bg-cover bg-primary bg-center bg-fixed w-screen">
  <div id="loading-indicator" class="flex items-center justify-center loading-indicator fixed top-0 bg-transparent backdrop-blur-lg hidden h-screen w-screen z-50">
    <div class="text-center">
      <div class="lds-ellipsis">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </div>
      <p class="animate-pulse text-xl font-bold text-white">Loading...</p>
      <p class="text-[5px] font-bold text-white">QuranQu</p>
    </div>
  </div>
  
  <section class="container text-center md:text-start mt-10 px-6 text-dark landing-page transition bg-transparent backdrop-blur-lg pt-10 md:pt-0 rounded-lg">
    <h3 class="relative md:top-9 font-extrabold">QuranQu</h3>
    <div class="flex flex-col md:flex-row items-center overflow-hidden py-14">
      <div class="flex-1 md:pr-16">
        <h1 class="font-bold text-3xl md:text-4xl mb-5 font-semibold">Baca Al-Qur'an Online</h1>
        <p class="md:text-lg"> Jelajahi ayat-ayat suci dan temukan makna yang dalam untuk hidup Anda. Mulailah perjalanan spiritual Anda dengan Al-Qur'an secara online. </p>
        <a href="#" onclick="invisible()" class="backdrop-blur-lg text-black border border-white rounded-full px-5 py-3 inline-block self-center font-bold mt-5 mx-auto text-white text-center shadow-lg shadow-white/50 animate-bounce hover:opacity-50">Get Started</a>
      </div>
      <div class="pt-14 relative -z-10">
        <div class="h-72 w-72 md:scale-[2] mx-auto bg-white/25 rounded-[100px] rotate-45 relative md:-right-7"></div>
        <img src="img/quran.png" class="absolute top-8 left-1/2 -translate-x-1/2 md:translate-x-0 md:-left-14 w-full md:scale-[1.25]" alt="QuranApp" />
      </div>
    </div>
  </section>
    <section class="text-white container flex flex-col items-center py-10 font-bold hidden jadwal-shalat">
    <h2 class="text-3xl font-bold">Selamat <span class="greeting">xxxx</span></h2>
    <div class="text-center font-extrabold my-10 py-14 rounded-lg shadow-lg bg-transparent backdrop-blur-lg w-full">
      <h4 class="text-2xl date">Sabtu, 10 Juni 2023</h4>
      <h1 class="text-4xl time mt-3">00:00:00</h1>
    </div>
    <div class="my-16 border border-white rounded-xl p-4 shadow-lg bg-transparent backdrop-blur-lg">
      <h2 class="text-center text-md font-bold">Ganti Background</h2>
      <div class="container scale-75 slct-bg bg-transparent bg-white backdrop-blur-lg rounded-full flex justify-evenly md:justify-center gap-7 p-3">
      <div data-bg="1" data-hex="#490C80" class="bg-[#490C80] h-10 w-10 rounded-full"></div>
      <div data-bg="2" data-hex="#C1B544" class="bg-[#C1B544] h-10 w-10 rounded-full"></div>
      <div data-bg="3" data-hex="#975531" class="bg-[#975531] h-10 w-10 rounded-full"></div>
      <div data-bg="4" data-hex="#812A2A" class="bg-[#812A2A] h-10 w-10 rounded-full"></div>
      <div data-bg="5" data-hex="#00336F" class="bg-[#00336F] h-10 w-10 rounded-full"></div>
    </div>
    <div class="flex items-center gap-2 mx-auto w-fit">
      <input type="checkbox" name="" id="bg" />
      <label for="bg" class="font-light">Sertakan Gambar</label>

    </div>
    </div>
    <h1 class="text-xl font-bold mb-5">Jadwal Shalat üáÆüá©</h1>
    <select class="kota bg-transparent backdrop-blur-lg rounded-full shadow-lg p-3 hover:bg-dark/50 border border-white">
      <option hidden>Pilih Lokasi</option>
    </select>
    <label for="date" class="backdrop-blur-lg p-3 rounded-full my-5 shadow-lg hover:bg-dark/50 border border-white">Set Date üìÖ</label>
    <input type="date" class="sr-only slct-date" value="set date" id="date"/>
    <div class="bg-transparent backdrop-blur-lg w-full py-5">
      <div class="jadwal-info"></div>
      <div class="hidden jadwal-cont grid place-items-center grid-cols-1 md:grid-cols-2 w-full rounded-lg p-5 gap-5 font-bold shadow-lg">
      </div>
    </div>
  </section>
  
  <input type="text" id="search-box" placeholder="üîç Cari Surat..." class="hidden block m-auto text-center border border-white rounded-full border-2 bg-transparent p-3 my-8 placeholder-white" />
  <a href="#" class="fixed bg-white/50 backdrop-blur-md rounded-full h-10 w-10 grid place-items-center top-[90vh] right-10 animate-bounce z-50">‚òùÔ∏è</a>
  <section class="container hidden surat-cont grid md:grid-cols-2 gap-4 md:gap-8">
  </section>
  <div class="hidden ayat-cont flex flex-col items-center my-10">
    <div class="flex flex-wrap flex-col md:flex-row justify-center items-center gap-8 text-sm text-white container">
      <div class="flex flex-col md:flex-row items-center gap-8 text-center">
        <div class="surat-info text-dark"></div>
        <audio class="audio rounded-full border border-2 border-white" controls preload="none">
        </audio>
      </div>
      <div class="flex flex-wrap gap-5 justify-center">
        <select class="qari p-3 font-bold rounded-lg bg-transparent backdrop-blur-lg border border-white">
          <option value="01">Abdullah Al Juhany</option>
          <option value="02">Abdul Muhsin Al Qasim</option>
          <option value="03">Abdurrahman as Sudais</option>
          <option value="04">Ibrahim Al Dosari</option>
          <option value="05" selected>Misyari Rasyid Al-Afasi</option>
        </select>
        <input type="checkbox" class="sr-only" id="desk" />
        <button class="bg-transparent backdrop-blur-lg border border-white font-bold rounded-lg p-3 tafsir-btn" onclick="tafsirSurat()">Tafsir</button>
        <label for="desk" class="bg-transparent backdrop-blur-lg border border-white font-bold rounded-lg p-3">Deskripsi</label>
        <p class="deskripsi peer-checked:hidden mt-5 text-dark border-dotted border-white border-2 rounded-lg p-7 hidden bg-white leading-7"></p>
      </div>
    </div>
    <section class="surat p-5">
    </section>
  </div>
  <section class="tafsir-cont hidden container my-10">
    <div class="tafsir-info text-center"></div>
  </section>
  
    
    <footer class="pb-10 pt-20 w-screen bg-transparent backdrop-blur-lg">
      <h4 class="text-center text-sm font-extrabold">&copy;2023 QuranQu</h4>
    </footer>
  
   <script type="text/javascript" charset="utf-8">
    
    let setDate = document.querySelector("input[type='date']"),
        inpKota = document.querySelector(".kota"),
        timeCont = document.querySelector(".time"),
        dateCont = document.querySelector(".date"),
        greeting = document.querySelector(".greeting"),
        jadwal = document.querySelector(".jadwal-shalat"),
        jadwalCont = document.querySelector(".jadwal-cont"),
        jadwalInfo = document.querySelector(".jadwal-info"),
        bgCbox = document.querySelector("#bg"),
        select = document.querySelector(".slct-bg"),
        date = new Date();
        
    select.addEventListener("click", e => {
      const selectedBg = e.target.dataset.bg,
            selectedHex = e.target.dataset.hex;
      if(selectedBg != undefined) {
        if(bgCbox.checked) {
        document.body.style.backgroundImage = `url(./img/${selectedBg}.png)`;
        } else {
          document.body.style.backgroundImage = `none`;
          document.body.style.backgroundColor = selectedHex;
        }
      }
    });
    
    fetch("https://api.myquran.com/v1/sholat/kota/semua")
      .then(res => res.json())
      .then(res => {
        const sortedKota = res.sort((a, b) => a.lokasi.localeCompare(b.lokasi));
    
        let kotaItems = "";
        sortedKota.forEach(kota => {
          kotaItems += `<option value="${kota.id}">${kota.lokasi.replace('KAB. ', '')}</option>`;
        });
        inpKota.innerHTML += kotaItems;
      });
      
      
    inpKota.addEventListener("change", () => {
      let slctOpt = inpKota.options[inpKota.selectedIndex],
          locationID = slctOpt.value,
          location = slctOpt.textContent;
          defaultDate = new Date().toLocaleDateString('zh-Hans-CH'),
          slctDate = document.querySelector(".slct-date").value.split("-").join("/");
          url = `https://api.myquran.com/v1/sholat/jadwal/${locationID}/${slctDate == "" ? defaultDate : slctDate}`
        console.log(url)
      fetch(url).then(res => res.json()).then(res => {
        jadwalCont.classList.remove("hidden");
        console.log(slctDate)
        const jadwalShalat = res.data.jadwal;
        jadwalInfo.innerHTML = `
        <p class="text-center">Jadwal Shalat ${location} hari <br>${jadwalShalat.tanggal}</p>`;
        jadwalCont.innerHTML = `
          <div class="jadwal">
            <p>Subuh</p>
            <p>${jadwalShalat.subuh}</p>
          </div>
          <div class="jadwal">
            <p>Terbit</p>
            <p>${jadwalShalat.terbit}</p>
          </div>
          <div class="jadwal">
            <p>Maghrib</p>
            <p>${jadwalShalat.maghrib}</p>
          </div>
          <div class="jadwal">
            <p>Dzuhur</p>
            <p>${jadwalShalat.dzuhur}</p>
          </div>
          <div class="jadwal">
            <p>Ashar</p>
            <p>${jadwalShalat.ashar}</p>
          </div>
          <div class="jadwal">
            <p>Isya</p>
            <p>${jadwalShalat.isya}</p>
          </div>
        `;
        console.log(slctDate)
      })
      console.log("ID:", locationID);
      console.log("Text:", location);
      console.log("Date:", date);
});

    
    const hour = date.getHours();
    greeting.innerHTML =
      hour >= 5 && hour < 12 ? 'Pagi ‚òÄÔ∏è' :
      hour >= 12 && hour < 15 ? 'Siang üåû' :
      hour >= 15 && hour < 18 ? 'Sore üåÖ' : 'Malam üåô';
    
    const formattedDate = date.toLocaleDateString('id-ID', { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
    });
    dateCont.innerHTML = formattedDate;
      
    setInterval(() => {
      let date = new Date();
      const formattedTime = date.toLocaleTimeString('en-US', {hour12:false});
      timeCont.innerHTML = formattedTime;
    }, 1000);




  </script>
  <script type="text/javascript" charset="utf-8">
  
  
  
  
    let suratContainer = document.querySelector('.surat-cont'),
  ayatContainer = document.querySelector('.ayat-cont'),
  tafsirContainer = document.querySelector('.tafsir-cont'),
  suratInfo = document.querySelector(".surat-info"),
  searchBox = document.querySelector('#search-box'),
  loadingIndicator = document.querySelector('.loading-indicator'),
  qari = document.querySelector('.qari'),
  audioFull = document.querySelector('audio'),
  suratURL = "";


function invisible() {
  loadingIndicator.style.display = 'flex';
  suratContainer.classList.remove("hidden");
  jadwal.classList.remove("hidden");
  searchBox.classList.remove("hidden")
  const lp = document.querySelector(".landing-page")
  lp.classList.add("invisible");
  setTimeout(() => {
    lp.classList.add("hidden")
    loadingIndicator.style.display = 'none';
  }, 1000);
}


function tafsirSurat() {
  const id = ayatContainer.querySelector('.ayat-elem').dataset.id;
  tafsirContainer.classList.remove("hidden")
  suratContainer.classList.add("hidden");
  ayatContainer.classList.add("hidden");
  loadingIndicator.style.display = 'flex';
  
  fetch(`https://equran.id/api/v2/tafsir/${id}`).then(res => res.json()).then(res => {
    loadingIndicator.style.display = 'none';
    const tafsirInfo = document.querySelector(".tafsir-info");
    tafsirInfo.innerHTML = `
      <h1 class="text-xl font-bold">Tafsir surat <i>${res.data.namaLatin}</i></h1>`;
    let tafsirHTML = '';
    res.data.tafsir.forEach((ayat, index) => {
      index += 1;
      tafsirHTML += `
        <div class="my-4 md:mx-8">
          <input type="checkbox" id="tafsir${index}" class="peer sr-only" />
          <label for="tafsir${index}" class="text-xl font-bold bg-transparent backdrop-blur-lg block p-4 text-white rounded-lg peer-checked:rounded-b-none flex justify-between hover:opacity-75 transition hover:animate-pulse">
              <span>Ayat ke-${index}</span>
              <span>üìñ</span>
            </label>
            <p class="px-1.5 py-2 hidden border border-white border-4 rounded-b-lg peer-checked:block">${ayat.teks}
            </p>
          </div>
       `;
    })
    tafsirContainer.innerHTML += tafsirHTML;
  })
}
loadingIndicator.style.display = 'flex';
fetch("https://equran.id/api/v2/surat").then(response => response.json()).then(data => {
  // Proses respons API
  let suratHTML = "";
  for (const surat of data.data) {
    suratHTML += `
      <div class="letter shadow-lg p-8 flex items-center gap-4 rounded-2xl hover:bg-dark/25 hover:text-cyan-50 group transition-all duration-300 ease-in-out border border-white border-2 bg-transparent backdrop-blur-lg">
        <div class="rounded-full flex items-center justify-center h-10 w-10 border-dotted border-2 border-white group-hover:border-cyan-50">${surat.nomor}</div>
          <div class="grid">
          <h4 class="font-bold">${surat.namaLatin} (${surat.nama})</h4>
          <div class="flex gap-3 text-xs">
            <p>${surat.arti} - </p>
            <p>${surat.jumlahAyat} Ayat</p>
          </div>
        </div>
      </div>
    `;
  }
  suratContainer.innerHTML = suratHTML;
  // Live search
  const suratItems = Array.from(suratContainer.getElementsByClassName('letter'));
  searchBox.addEventListener('input', function() {
    const searchValue = this.value.toLowerCase();
    suratItems.forEach(item => {
      const text = item.textContent.toLowerCase();
      item.style.display = text.includes(searchValue) ? '' : 'none';
    });
  });
  
  
  for (const item of suratItems) {
    item.addEventListener('click', () => {
      searchBox.classList.add("hidden")
      loadingIndicator.style.display = 'flex';
      const suratNumber = item.children[0].textContent;
      suratURL = `https://equran.id/api/v2/surat/${suratNumber}`;
      fetch(suratURL).then(res => res.json()).then(res => {
        const surat = res.data;
        console.log(surat)
        suratInfo.innerHTML = `
          <h1 class="text-6xl">${surat.nama}</h1>
          <p class="text-lg">(${surat.namaLatin})</p>
          <div>
            <span>${surat.arti} ‚Ä¢ </span>
            <span>${surat.jumlahAyat} Ayat ‚Ä¢ </span>
            <span>${surat.tempatTurun}</span>
          </div>
        `;
        loadingIndicator.style.display = 'none';
        const ayats = res.data.ayat.map(ayat => createAyatElement(ayat, ayat.audio['05'], res.data.nomor));
        audioFull.innerHTML = `<source src="${res.data.audioFull["05"]}"></source>`;
        document.querySelector('.deskripsi').innerHTML = res.data.deskripsi;
        document.querySelector('.surat').innerHTML = ayats.join('');
      });
      suratContainer.classList.add("hidden")
      ayatContainer.classList.remove("hidden")
      jadwal.classList.add("hidden")
    });
  }
  loadingIndicator.style.display = 'none';
})


function createAyatElement(ayat, audio, nomor) {
  return `
    <div class="container ayat-elem my-6 shadow-lg rounded-2xl p-4 bg-transparent backdrop-blur-lg" data-id="${nomor}">
      <p class="text-center mb-3">${ayat.nomorAyat}:${nomor}</p>
      <p class="text-center">
        <audio src="${audio}" preload="none" ></audio>
        <button class="text-4xl mb-5 text-center" onclick="toggleAudio(this)">${ayat.teksArab}<span class="mt-5 block text-sm">üîä</span></button>
      </p>
      <p class="border-b border-b-2 border-b-white pb-2 italic text-sm">${ayat.teksLatin}</p>
      <p class="mt-2 text-sm">${ayat.teksIndonesia}</p>
    </div>`;
}


qari.addEventListener("change", () => {
  fetch(suratURL).then(res => res.json()).then(res => {
    const ayats = res.data.ayat.map(ayat => createAyatElement(ayat, ayat.audio[qari.value], res.data.nomor));
    document.querySelector('.surat').innerHTML = ayats.join('');
  })
})


// putar audio saat ayat diklik
function toggleAudio(button) {
  const audio = button.parentNode.querySelector('audio');
  if (audio.paused) {
    audio.play();
  } else {
    audio.pause();
    audio.currentTime = 0;
  }
}


history.pushState(null, null, location.href);
window.addEventListener('popstate', () => {
  if (suratContainer.classList.contains("hidden")) {
    ayatContainer.classList.add("hidden");
    tafsirContainer.classList.add("hidden");
    suratContainer.classList.remove("hidden")
    jadwal.classList.remove("hidden");
    searchBox.classList.remove("hidden");
  } 
})
window.addEventListener('popstate', () => {
  history.pushState(null, null, location.href);
});

  </script>
</body>
</html>